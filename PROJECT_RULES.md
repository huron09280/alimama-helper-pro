# 阿里妈妈多合一助手 - 项目专用工程规则

为了确保项目的 UI 一致性与代码稳定性，在后续维护中请遵循以下特定规则：

## 一、 UI 与交互规范

### 1. 面板联动逻辑

* **自动最小化**：当点击主面板上的特定功能模块（如“算法护航”）激活独立 UI 时，**必须**自动最小化主助手面板，以节省屏幕空间并减少视觉干扰。

### 2. 关闭与隐藏

* **直接关闭**：对于独立的功能面板，应优先使用直接“关闭/隐藏”行为。
* **简洁 UI**：除非用户明确要求，否则避免在面板外保留冗余的悬浮球或最小化图标（盾牌等）。

### 3. 层级 (z-index) 规范

* **主面板**：z-index 约定为 `999999`。
* **次级面板/功能模块**：z-index 必须大于主面板（如 `1000001`）。
* **全局遮罩/结果弹窗**：z-index 必须最高（如 `1000002` 以上），确保不被任何 UI 遮挡。

## 二、 版本管理规范

### 1. 单一版本源

* 本项目采用动态版本同步机制。
* **CURRENT_VERSION**：应通过 `GM_info.script.version` 动态获取脚本头部的 `@version`。
* **动态显示**：主面板头部、护航面板标题、以及控制台启动日志中的版本号**严禁硬编码**，必须统一引用版本变量进行显示。

### 2. 作用域兼容

* 当脚本包含多个独立模块（多个 IIFE）时，需确保每个模块内部都能正确解析版本变量，可以通过在模块内部重新声明版本常量来实现。

## 三、 日志规范

### 1. 日志按天合并

* **日期标题**：主面板日志系统必须支持按日期分组。
* **合并逻辑**：同一天的日志应紧随在同一个日期标题（格式如 `2026-02-08`）之下，不应重复产生日期行。
* **顺序**：最新的日志应显示在最下方并支持自动滚动。

## 四、 合并与维护

* 在合并外部 UserScript（如护航脚本）时，应保持其核心逻辑作为相对独立的 IIFE 存在，仅通过特定的全局变量（如 `window.__ALIMAMA_OPTIMIZER_TOGGLE__`）与主脚本 UI 进行通信。
